<form class="form" novalidate
(ngSubmit)="onSubmit()"

[formGroup]="carForm">
<fieldset (change)="onControlChange($event.target)">
    <div class="form__group">
    <label class="form__label" for="year">Год выпуска:</label>
    <select class="form__control" formControlName="year"
    name="year" id="year">
      <option value="">Укажите год выпуска</option>
      <option *ngFor="let year of yearsList" value="{{year}}">{{year}}</option>
    </select>
  </div>
  <div class="form__alert" *ngIf="isInvalid('year')">
    Поле должно быть заполнено
  </div>
  <div class="form__group" 
  *ngIf="carForm.controls.year.value && makesList$ | async">
    <label class="form__label" for="make">Марка:</label>
    <select class="form__control" formControlName="make"
    name="make" id="make">
      <option value="">Укажите марку</option>
      <option *ngFor="let make of makesList$ | async" value="{{make}}">{{make}}</option>
    </select>
  </div>
    <div class="form__alert" *ngIf="isInvalid('make')">
    Поле должно быть заполнено
  </div>
  <div class="form__group" *ngIf="modelsList$ | async">
    <label class="form__label" for="model">Модель:</label>
    <select class="form__control" formControlName="model"
    name="model" id="model">
      <option value="">Укажите модель</option>
      <option *ngFor="let model of modelsList$ | async" value="{{model}}">{{model}}</option>
    </select>
  </div>
    <div class="form__alert" *ngIf="isInvalid('model')">
    Поле должно быть заполнено
  </div>
  <div class="form__group" *ngIf="trimsList$ | async">
    <label class="form__label" for="trim">Комплектация:</label>
    <select class="form__control" formControlName="trim"
    name="trim" id="trim">
      <option value="">Укажите комплектацию</option>
      <option *ngFor="let trim of trimsList$ | async" value="{{trim}}">{{trim}}</option>
    </select>
  </div>
  <div class="form__alert" *ngIf="isInvalid('trim')">
    Поле должно быть заполнено
  </div>
</fieldset>

  <div *ngIf="carForm.controls.trim.value">
    <div class="form__group" >
      <label class="form__label" for="isSale">Скидка:</label>
      <input formControlName="isSale"
      class="form__control" type="checkbox"
      name="isSale" id="isSale">
    </div>
    <div class="form__group" formArrayName="carImages">
      <label class="form__label" for="carImages">Добавить изображение:</label>
      <input *ngFor="let image of carImages.controls; let i = index"
      class="form__control" type="file"
      name="carImages" id="carImages"
      formControlName="{{i}}">
    </div>
  </div> 
</form>
<pre>
  {{carForm.value | json}}
</pre>

